# Homework

1. Для старта домашки:
```bash
docker compose -f docker-compose.aug.yml up --build
```
2. Логи выполнения homework:
Attaching to ttp-1, worker1-1, worker2-1
worker2-1  | 2025-10-10 19:15:16,279 [INFO]: ==================
worker2-1  | 2025-10-10 19:15:16,280 [INFO]: DistributedCommunicator with rank 1
worker2-1  | 2025-10-10 19:15:16,280 [INFO]: ==================                                                                                
worker1-1  | 2025-10-10 19:15:16,306 [INFO]: ==================                                                                                
worker1-1  | 2025-10-10 19:15:16,306 [INFO]: DistributedCommunicator with rank 0
worker1-1  | 2025-10-10 19:15:16,306 [INFO]: ==================                                                                                
worker1-1  | 2025-10-10 19:15:17,308 [INFO]: Added key: store_based_barrier_key:1 to store for rank: 0                                         
worker2-1  | 2025-10-10 19:15:17,308 [INFO]: Added key: store_based_barrier_key:1 to store for rank: 1
                                                                                                                                               

worker2-1  | 2025-10-10 19:15:17,342 [INFO]: Added key: store_based_barrier_key:2 to store for rank: 1
                                                                                                                                               
                                                                                                                                               
worker1-1  | 2025-10-10 19:15:17,342 [INFO]: Added key: store_based_barrier_key:2 to store for rank: 0
worker2-1  | 2025-10-10 19:15:17,354 [INFO]: Added key: store_based_barrier_key:3 to store for rank: 1
worker1-1  | 2025-10-10 19:15:17,366 [INFO]: Added key: store_based_barrier_key:3 to store for rank: 0


worker1-1  | 2025-10-10 19:15:17,378 [INFO]: Added key: store_based_barrier_key:4 to store for rank: 0
worker2-1  | 2025-10-10 19:15:17,378 [INFO]: Added key: store_based_barrier_key:4 to store for rank: 1
worker1-1  | 2025-10-10 19:15:17,379 [INFO]: World size = 2                                                                                    
                                                                                                                                               
                                                                                                                                               
                                                                                                                                               
worker2-1  | 2025-10-10 19:15:17,379 [INFO]: World size = 2
worker2-1  | 2025-10-10 19:15:17,390 [INFO]: TTPClient 1 initialized                                                                           
worker1-1  | 2025-10-10 19:15:17,390 [INFO]: TTPClient 0 initialized
worker2-1  | 2025-10-10 19:15:17,800 [INFO]: [Epoch 01] avg_loss=0.488616943359375                                                             
worker1-1  | 2025-10-10 19:15:17,809 [INFO]: [Epoch 01] avg_loss=0.488616943359375
worker1-1  | 2025-10-10 19:15:18,860 [INFO]: [Epoch 05] avg_loss=0.087371826171875                                                             
worker2-1  | 2025-10-10 19:15:18,863 [INFO]: [Epoch 05] avg_loss=0.087371826171875
worker1-1  | 2025-10-10 19:15:20,105 [INFO]: [Epoch 10] avg_loss=0.2020416259765625                                                            
worker2-1  | 2025-10-10 19:15:20,105 [INFO]: [Epoch 10] avg_loss=0.2020416259765625
worker1-1  | 2025-10-10 19:15:21,317 [INFO]: [Epoch 15] avg_loss=0.0721435546875                                                               
worker2-1  | 2025-10-10 19:15:21,320 [INFO]: [Epoch 15] avg_loss=0.0721435546875
worker1-1  | 2025-10-10 19:15:22,556 [INFO]: [Epoch 20] avg_loss=0.104888916015625                                                             
worker2-1  | 2025-10-10 19:15:22,557 [INFO]: [Epoch 20] avg_loss=0.104888916015625
worker2-1  | 2025-10-10 19:15:23,730 [INFO]: [Epoch 25] avg_loss=0.0671539306640625                                                            
worker1-1  | 2025-10-10 19:15:23,730 [INFO]: [Epoch 25] avg_loss=0.0671539306640625
                                                                                                                                               

worker1-1  | 2025-10-10 19:15:24,832 [INFO]: [Epoch 30] avg_loss=0.0714263916015625
worker1-1  | 2025-10-10 19:15:24,832 [INFO]: Model train elapsed time: 7.3030 seconds
worker1-1  | 2025-10-10 19:15:24,832 [INFO]: ====Communication Stats====                                                                       
worker1-1  | 2025-10-10 19:15:24,832 [INFO]: Rounds: 1447                                                                                      
worker1-1  | 2025-10-10 19:15:24,832 [INFO]: Bytes: 256017232.0                                                                                
                                                                                                                                               
                                                                                                                                               
worker2-1  | 2025-10-10 19:15:24,832 [INFO]: [Epoch 30] avg_loss=0.0714263916015625
worker2-1  | 2025-10-10 19:15:24,832 [INFO]: Model train elapsed time: 7.3027 seconds
worker1-1  | 2025-10-10 19:15:24,832 [INFO]: Communication time: 4.0816168500150525                                                            
worker1-1  | 2025-10-10 19:15:24,880 [INFO]: *Test MSE (encrypted): 0.0765228271484375*                                                          
worker2-1  | 2025-10-10 19:15:24,881 [INFO]: Test MSE (encrypted): 0.0765228271484375


worker1-1  | 2025-10-10 19:15:29,891 [INFO]: *Learned weights (plaintext)*: tensor([ 0.0423,  0.0385,  0.0722, -0.1024,  0.0105, -0.0928, -0.1140, -0.0172,
worker1-1  |          0.0250,  0.0746,  0.0937,  0.0532, -0.0062,  0.0534, -0.1239, -0.0156,
worker1-1  |          0.1005, -0.0649,  0.0560,  0.0102,  0.0628, -0.0052,  0.0233,  0.0312,                                                   
worker1-1  |         -0.0710,  0.0773,  0.0030, -0.0236, -0.0331, -0.0480, -0.0930,  0.0360,                                                   
worker1-1  |          0.0289,  0.0996, -0.0173,  0.0106,  0.0593,  0.0854, -0.0497,  0.0035,                                                   
worker1-1  |          0.0469, -0.0762, -0.0874,  0.0151, -0.0360, -0.0056, -0.0577, -0.0503,                                                   
worker1-1  |          0.0345, -0.0466,  0.0151, -0.0193,  0.0220, -0.0142,  0.0462, -0.0220,                                                   
worker1-1  |         -0.0696, -0.0756,  0.0496, -0.0442, -0.0023,  0.0508, -0.1071,  0.0396])                                                  
worker1-1  | 2025-10-10 19:15:29,891 [INFO]: Learned bias (plaintext): 0.6090087890625



worker1-1  | 2025-10-10 19:15:29,891 [INFO]: *Learned weights share*: tensor([-5083971167446877388,  8214413764462913476,  -371084268415659342,  
worker1-1  |           735734709044063092,  3500157070859627073, -7398469096308759532,                                                         
worker1-1  |         -8478471266048227377,  -556094624777979758,  1073079344283467858,                                                         
worker1-1  |         -5289743446380424087,  6825159485581562980,  5986842488309618358,                                                         
worker1-1  |         -5329255950551567035, -6623710826672587293,  1098121338925874281,                                                         
worker1-1  |         -7332685556335180121,   510905785558707610,  4919737357047926874,                                                         
worker1-1  |         -2026511257639556097,    14962392505288645,  4353117630355856557,                                                         
worker1-1  |         -6271899767409243128,  -105295920430531517,  8965761941684532274,                                                         
worker1-1  |          7384885252996585107,  6587912940210023223, -1106914545309696071,
worker1-1  |          3719557744444532562, -6211458654677079693, -6916997489742340390,                                                         
worker1-1  |         -3980636181982714048, -5105238332363277853, -2950619381589083389,                                                         
worker1-1  |         -4069698417981201070, -1988300436150861627,  5589110794902426896,                                                         
worker1-1  |          7145388089502979822,  4984426899859821814,  6045404501414446750,                                                         
worker1-1  |          1799404830253864770, -7379595260329532363,  6205737363596492803,                                                         
worker1-1  |         -1288505899745686410, -8284416620738890658, -5674789247635607206,
worker1-1  |         -2251097155661081120, -3677902282392932549, -1676135168383439144,                                                         
worker1-1  |          5784002567697964473, -9113971178414699896, -7471160807811884651,                                                         
worker1-1  |         -2276970126937631492, -7056042273542336703, -7612378893430844590,                                                         
worker1-1  |         -7591681592405195503, -3005594800749886432,   569230498280813082,                                                         
worker1-1  |          2636130405651865654,  1478694248824923375,  4219091417316790146,                                                         
worker1-1  |         -1503118912844407390, -2776041654410437332, -3219328990430310168,                                                         
worker1-1  |          7739475194720330045])                                                                                                    
worker1-1  | 2025-10-10 19:15:29,891 [INFO]: Learned bias share: 2292598231210270555
ttp-1 exited with code 0
worker1-1 exited with code 0




worker2-1  | 2025-10-10 19:15:34,895 [INFO]: *Learned weights share*: tensor([ 5083971167446880159, -8214413764462910953,   371084268415664074,
worker2-1  |          -735734709044069803, -3500157070859626384,  7398469096308753448,
worker2-1  |          8478471266048219906,   556094624777978631, -1073079344283466221,                                                         
worker2-1  |          5289743446380428975, -6825159485581556838, -5986842488309614871,                                                         
worker2-1  |          5329255950551566628,  6623710826672590792, -1098121338925882401,                                                         
worker2-1  |          7332685556335179100,  -510905785558701023, -4919737357047931127,                                                         
worker2-1  |          2026511257639559765,   -14962392505287974, -4353117630355852441,                                                         
worker2-1  |          6271899767409242785,   105295920430533045, -8965761941684530231,                                                         
worker2-1  |          7332685556335179100,  -510905785558701023, -4919737357047931127,
worker2-1  |          2026511257639559765,   -14962392505287974, -4353117630355852441,
worker2-1  |          6271899767409242785,   105295920430533045, -8965761941684530231,
worker2-1  |         -7384885252996589757, -6587912940210018156,  1106914545309696266,
worker2-1  |         -3719557744444534108,  6211458654677077522,  6916997489742337245,
worker2-1  |          3980636181982707953,  5105238332363280212,  2950619381589085285,
worker2-1  |          2026511257639559765,   -14962392505287974, -4353117630355852441,
worker2-1  |          6271899767409242785,   105295920430533045, -8965761941684530231,
worker2-1  |         -7384885252996589757, -6587912940210018156,  1106914545309696266,
worker2-1  |         -3719557744444534108,  6211458654677077522,  6916997489742337245,
worker2-1  |          3980636181982707953,  5105238332363280212,  2950619381589085285,
worker2-1  |          6271899767409242785,   105295920430533045, -8965761941684530231,
worker2-1  |         -7384885252996589757, -6587912940210018156,  1106914545309696266,
worker2-1  |         -3719557744444534108,  6211458654677077522,  6916997489742337245,
worker2-1  |          3980636181982707953,  5105238332363280212,  2950619381589085285,
worker2-1  |          4069698417981207600,  1988300436150860493, -5589110794902426202,
worker2-1  |         -7384885252996589757, -6587912940210018156,  1106914545309696266,
worker2-1  |         -3719557744444534108,  6211458654677077522,  6916997489742337245,
worker2-1  |          3980636181982707953,  5105238332363280212,  2950619381589085285,
worker2-1  |          4069698417981207600,  1988300436150860493, -5589110794902426202,
worker2-1  |          3980636181982707953,  5105238332363280212,  2950619381589085285,
worker2-1  |          4069698417981207600,  1988300436150860493, -5589110794902426202,
worker2-1  |         -7145388089502975933, -4984426899859816214, -6045404501414450008,
worker2-1  |         -1799404830253864541,  7379595260329535439, -6205737363596497795,
worker2-1  |          1288505899745680681,  8284416620738891650,  5674789247635604844,
worker2-1  |          4069698417981207600,  1988300436150860493, -5589110794902426202,
worker2-1  |         -7145388089502975933, -4984426899859816214, -6045404501414450008,
worker2-1  |         -1799404830253864541,  7379595260329535439, -6205737363596497795,
worker2-1  |          1288505899745680681,  8284416620738891650,  5674789247635604844,
worker2-1  |          2251097155661080751,  3677902282392928766,  1676135168383435850,
worker2-1  |         -7145388089502975933, -4984426899859816214, -6045404501414450008,
worker2-1  |         -1799404830253864541,  7379595260329535439, -6205737363596497795,
worker2-1  |          1288505899745680681,  8284416620738891650,  5674789247635604844,
worker2-1  |          2251097155661080751,  3677902282392928766,  1676135168383435850,
worker2-1  |          1288505899745680681,  8284416620738891650,  5674789247635604844,
worker2-1  |          2251097155661080751,  3677902282392928766,  1676135168383435850,
worker2-1  |          2251097155661080751,  3677902282392928766,  1676135168383435850,
worker2-1  |         -5784002567697962212,  9113971178414696841,  7471160807811885640,
worker2-1  |         -5784002567697962212,  9113971178414696841,  7471160807811885640,
worker2-1  |          2276970126937630230,  7056042273542338144,  7612378893430843659,
worker2-1  |          2276970126937630230,  7056042273542338144,  7612378893430843659,
worker2-1  |          7591681592405198532,  3005594800749884987,  -569230498280817643,
worker2-1  |         -2636130405651870607, -1478694248824920125, -4219091417316793043,
worker2-1  |          7591681592405198532,  3005594800749884987,  -569230498280817643,
worker2-1  |         -2636130405651870607, -1478694248824920125, -4219091417316793043,
worker2-1  |          1503118912844407237,  2776041654410440658,  3219328990430303152,
worker2-1  |         -7739475194720327447])
worker2-1  |         -2636130405651870607, -1478694248824920125, -4219091417316793043,
worker2-1  |          1503118912844407237,  2776041654410440658,  3219328990430303152,
worker2-1  |         -7739475194720327447])
worker2-1  |          1503118912844407237,  2776041654410440658,  3219328990430303152,
worker2-1  |         -7739475194720327447])
worker2-1  | 2025-10-10 19:15:34,896 [INFO]: Learned bias share: -2292598231210230643
worker2-1  |         -7739475194720327447])
worker2-1  | 2025-10-10 19:15:34,896 [INFO]: Learned bias share: -2292598231210230643
worker2-1  | 2025-10-10 19:15:34,896 [INFO]: Learned bias share: -2292598231210230643
worker2-1 exited with code 0
worker2-1 exited with code 0


# crypten-linreg

Обучение линейной регрессии в CrypTen.

Скрипт генерации данных и открытое обучение линейной регрессии в pytorch в `notebooks/linreg-plain.ipynb`.

Для запуска:
1. Указать в `docker-compose.yml` в разделе `command` для каждого воркера нужную функцию из `src/tasks/mpc.py`.
2. Выполнить `docker compose up`.

После внесения изменений в код:
1. Остановить и удалить прерыдущие контейнеры: 
```bash
docker compose down
```

2. Запустить, пересобрав новые образы:
```bash
docker compose up --build
```